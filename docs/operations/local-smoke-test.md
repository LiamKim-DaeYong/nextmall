# 로컬 스모크 테스트 가이드 (초안)

목표: 게이트웨이 기반 토큰 발급부터 핵심 데이터 흐름까지 “한 번에 검증”할 수 있는 최소 루틴을 정의한다.

---

## 1. 사전 조건
- 로컬에서 모든 서비스 기동 가능
- Docker Compose 사용 가능 (있다면)

## 2. 기동 순서 (권장)
1) 인프라: DB / Redis / Kafka (필요 시)
2) Auth Service
3) API Gateway
4) User / Product / Order / Checkout
5) BFF

> 순서는 “토큰 발급 → 게이트웨이 검증 → 비즈니스 서비스” 흐름을 기준으로 한다.

## 3. 스모크 시나리오 (최소)

### 3.1 토큰 발급 확인
- 목적: Auth → Gateway 경로가 정상인지 확인
- 검증 항목
  - Access Token 발급 성공
  - Refresh Token 발급 성공

### 3.2 Gateway 경유 요청 확인
- 목적: Gateway가 토큰 검증 후 내부 서비스로 라우팅하는지 확인
- 검증 항목
  - 인증 필요 API 호출 성공
  - Passport 발급 및 전달 정상

### 3.3 데이터 흐름 확인 (Product 기준)
- 목적: 서비스 간 데이터 흐름이 정상인지 확인
- 최소 흐름
  1) 상품 생성
  2) 상품 조회
  3) (선택) ProductCreated 이벤트 발생 확인

## 4. 실패 시 확인 포인트
- 토큰 발급 실패: Auth Service 및 키 설정
- Gateway 라우팅 실패: Gateway 라우팅 설정 및 보안 필터
- 데이터 처리 실패: 각 서비스 로그 및 DB 상태
- 이벤트 미발행: Kafka 연결 및 프로듀서 설정

## 5. 최소 자동화 제안
- 스모크 테스트는 “2~3개 API 호출”만 자동화해도 효과가 큼
- 헬스체크 성공 후 테스트를 실행하도록 구성

---

## 향후 확장
- Order/Checkout 시나리오 추가
- Kafka 소비자 처리 결과 검증
- 계약 테스트 및 OpenAPI 검증 추가
